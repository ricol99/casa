{
   "casa": {
      "uName": "casa:test-ensuite",
      "displayName": "Casa Collin Test Ensuite",
      "gang": "gang:collin-test",
      "listeningPort": 8084
   },
   "services": [
      {
         "uName": "webservice",
         "port": 11003,
         "mediaPath": "/Users/richardcollin/personal/media",
         "secure": false,
         "serverKey": "",
         "serverCert": "",
         "caCert": ""
      }
   ],
   "scenes": [
   ],
   "things": [
      {
         "uName": "tester:ensuite",
         "displayName": "Test thing:ensuite attached to bedroom with two users",
         "targetUnderTest": "ensuite:test-ensuite",
         "sources": [
            { "uName": "bedroom:test-bedroom", "property": "test-1-user-state" },
            { "uName": "bedroom:test-bedroom", "property": "test-2-user-state" },
            { "uName": "bedroom:test-bedroom", "property": "room-state" },
            { "property": "power" },
            { "property": "brightness" },
            { "property": "room-state" },
            { "property": "user-sensitivity-state" }
         ],
         "testRun": {
         },
         "testCases": [
            {
               "name": "1) Normal - both going to bed slightly different times - initiation by bed switches",
               "driveSequence": [
                  { "target": "building:test-building", "property": "test-1-present", "value": true },
                  { "target": "building:test-building", "wait": 0.2, "property": "test-2-present", "value": true },
                  { "target": "bedroom:test-bedroom", "wait": 0.2, "property": "evening-possible", "value": true },
                  { "target": "bedroom:test-bedroom", "wait": 0.2, "property": "low-light", "value": true },
                  { "wait": 0.2, "property": "evening-possible", "value": true },
                  { "wait": 0.2, "property": "low-light", "value": true },
                  { "target": "bedroom:test-bedroom", "wait": 0.2, "property": "movement", "value": true },
                  { "target": "bedroom:test-bedroom", "wait": 0.1, "property": "movement", "value": false },
                  { "wait": 0.1, "property": "movement", "value": true },
                  { "wait": 0.2, "property": "movement", "value": false },
                  { "target": "bedroom:test-bedroom", "wait": 0.2, "event": "test-1-switch-event" },
                  { "target": "building:test-building", "wait": 0.2, "property": "evening-possible", "value": false },
                  { "target": "bedroom:test-bedroom", "wait": 0.2, "event": "test-2-switch-event" },
                  { "target": "bedroom:test-bedroom", "wait": 2.5, "event": "test-1-switch-event" },
                  { "target": "bedroom:test-bedroom", "wait": 0.5, "event": "test-2-switch-event" },
                  { "wait": 2.0, "property": "low-light", "value": false },
                  { "target": "bedroom:test-bedroom", "wait": 0.1, "property": "low-light", "value": false },
                  { "target": "bedroom:test-bedroom", "wait": 1.0, "event": "wake-up-event" },
                  { "target": "building:test-building", "property": "test-1-present", "value": false },
                  { "target": "building:test-building", "wait": 0.5, "property": "test-2-present", "value": false }
               ],
               "expectedSequence": [
                  { "source": "bedroom:test-bedroom", "property": "room-state", "value": "no-users-present-evening" },
                  { "property": "room-state", "value": "no-users-present-evening" },
                  { "source": "bedroom:test-bedroom", "property": "room-state", "value": "users-present-evening" },
                  {
                     "simultaneous": [
                        { "property": "room-state", "value": "users-present-evening" },
                        { "property": "power", "value": true },
                        { "property": "brightness", "value": 20 },
                        { "property": "user-sensitivity-state", "value": "users-present-normal" }
                     ]
                  },
                  {
                     "simultaneous": [
                        { "source": "bedroom:test-bedroom", "property": "room-state", "value": "users-present-night" },
                        { "source": "bedroom:test-bedroom", "property": "test-1-user-state", "value": "initial-reading-in-bed" }
                     ]
                  },
                  {
                     "simultaneous": [
                        { "source": "bedroom:test-bedroom", "property": "test-2-user-state", "value": "initial-reading-in-bed" },
                        { "property": "user-sensitivity-state", "value": "users-present-sensitive" },
                        { "property": "brightness", "value": 5 }
                     ]
                  },
                  { "source": "bedroom:test-bedroom", "property": "room-state", "value": "no-users-present-night" },
                  {
                     "simultaneous": [
                        { "source": "bedroom:test-bedroom", "property": "test-1-user-state", "value": "asleep-in-bed" },
                        { "source": "bedroom:test-bedroom", "property": "test-2-user-state", "value": "reading-in-bed-others-asleep" }
                     ]
                  },
                  { "source": "bedroom:test-bedroom", "property": "test-2-user-state", "value": "asleep-in-bed" },
                  {
                     "simultaneous": [
                        { "property": "user-sensitivity-state", "value": "no-users-present-sensitive" },
                        { "property": "room-state", "value": "no-users-present-evening" },
                        { "property": "power", "value": false }
                     ]
                  },
                  { "property": "room-state", "value": "no-users-present-day" },
                  { "source": "bedroom:test-bedroom", "property": "room-state", "value": "no-users-present-day" },
                  {
                     "simultaneous": [
                        { "source": "bedroom:test-bedroom", "property": "test-2-user-state", "value": "awake-in-bed" },
                        { "source": "bedroom:test-bedroom", "property": "test-1-user-state", "value": "awake-in-bed" },
                        { "property": "user-sensitivity-state", "value": "no-users-present-normal" }
                     ]
                  },
                  {
                     "simultaneous": [
                        { "source": "bedroom:test-bedroom", "property": "test-1-user-state", "value": "not-present" },
                        { "source": "bedroom:test-bedroom", "property": "test-2-user-state", "value": "not-present" }
                     ]
                  }
               ]
            }
         ],
         "props": [],
         "things": []
      },
      {           
         "uName": "building:test-building",
         "displayName": "Test Building",
         "users": [ { "uName": "user:test-1" }, { "uName": "user:test-2" }, { "uName": "user:test-3" } ],
         "bedrooms": [  
            {           
               "uName": "bedroom:test-bedroom",
               "users": [ "user:test-1",  "user:test-2" ]
            }
         ],             
         "rooms": [],
         "allUsersLeftTimeout": 2,
         "propogateToParent": false,
         "props": [
            {
               "name": "daylight",
               "initialValue": false
            }
         ],
         "things": [
            {
               "uName": "thing:test-alarm",
               "displayName": "Test Alarm",
               "props": [
                  {
                     "name": "stay-armed",
                     "initialValue": false
                  },
                  {
                     "name": "fire-alarm",
                     "initialValue": false
                  },
                  {
                     "name": "zone-alarm",
                     "initialValue": false
                  }
               ],
               "things": []
            }
         ]
      },
      {
         "uName": "bedroom:test-bedroom",
         "displayName": "Test Bedroom",
         "users": [
            { "uName": "user:test-1" },
            { "uName": "user:test-2" }
         ],
         "building": "building:test-building",
         "readingInBedTimeout": 4,
         "awakeInBedTimeout": 1,
         "movementTimeout": 2,
         "events": [],
         "props": [
            {
               "name": "night-time",
               "initialValue": false
            },
            {
               "name": "movement",
               "initialValue": false
            },
            {
               "name": "low-light",
               "initialValue": false
            }
         ],
         "things": [
         ]
      },
      {
         "uName": "ensuite:test-ensuite",
         "displayName": "Test Ensuite",
         "bedroom": "bedroom:test-bedroom",
         "movementTimeout": 5,
         "events": [], 
         "props": [
            {
               "name": "night-time",
               "initialValue": false
            },
            {
               "name": "movement",
               "initialValue": false
            },
            {
               "name": "low-light",
               "initialValue": false
            }
         ],
         "things": [
          {
               "uName": "thing:test-main-lights",
               "displayName": "Test Main Lights",
               "props": [
                  {
                     "name": "room-state",
                     "type": "stateproperty",
                     "states": [
                        {
                           "name": "no-users-present-day",
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {
                           "name": "users-present-day",
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {
                           "name": "no-users-present-evening",
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {
                           "name": "users-present-evening",
                           "priority": 4,
                           "actions": [{ "property": "brightness", "value": 20 }, { "property": "power", "value": true }]
                        },
                        {
                           "name": "no-users-present-night",
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {
                           "name": "users-present-night",
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {
                           "name": "no-users-present-dull-day",
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {
                           "name": "users-present-dull-day",
                           "actions": [{ "property": "brightness", "value": 20 }, { "property": "power", "value": true }]
                        }
                     ]
                  },
                  {  
                     "name": "user-sensitivity-state",
                     "type": "stateproperty",
                     "states": [
                        {  
                           "name": "no-users-present-normal",
                           "priority": -1,
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {  
                           "name": "users-present-normal",
                           "priority": -1,
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {
                           "name": "no-users-present-sensitive",
                           "priority": 10,
                           "actions": [{ "property": "power", "value": false }]
                        },
                        {
                           "name": "users-present-sensitive",
                           "priority": 10,
                           "actions": [{ "property": "brightness", "value": 5 }, { "property": "power", "value": true }]
                        }
                     ]
                  },
                  {
                     "name": "power",
                     "initialValue": false
                  },
                  {
                     "name": "brightness",
                     "initialValue": 0
                  }
               ]
            }
         ]
      }
   ]
}
