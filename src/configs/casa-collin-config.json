{
   "name": "casa-collin",
   "displayName": "Casa Collin Home Automation System",
   "gang": "casa-collin",
   "location": {
      "latitude": 51.5,
      "longitude": -0.1
   },
   "props": [],
   "users": [ 
      {
         "name": "user:richard",
         "displayName": "Richard",
         "props": [
            {
               "name": "in-bed",
               "type": "scheduleproperty",
               "initialValue": false,
               "events": [
                  {
                     "name": "richard-wake-up-call",
                     "rule": "00 7 * * 1-5",
                     "value": "false"
                  },
                  {
                     "name": "richard-wake-up-call",
                     "rule": "00 9 * * 6-7",
                     "value": "false"
                  }
               ]
            },
            {
               "name": "at-home",
               "initialValue": false
            },
            {
               "name": "awake-at-home",
               "type": "andproperty",
               "initialValue": false,
               "sources": [
                  {
                     "name": "user:richard",
                     "property": "at-home"
                  },
                  {
                     "name": "user:richard",
                     "property": "in-bed",
                     "transform": "!$value"
                  }
               ]
            },
            {
               "name": "in-bed-at-home",
               "type": "andproperty",
               "initialValue": false,
               "sources": [
                  {
                     "name": "user:richard",
                     "property": "at-home"
                  },
                  {
                     "name": "user:richard",
                     "property": "in-bed"
                  }
               ]
            },
            {
               "name": "on-holiday",
               "initialValue": false
            }
         ]
      },
      {
         "name": "user:natalie",
         "displayName": "Natalie",
         "props": [
            {
               "name": "in-bed",
               "type": "scheduleproperty",
               "initialValue": false,
               "events": [
                  {
                     "name": "natalie-wake-up-call",
                     "rule": "45 6 * * 1-5",
                     "value": "false"
                  },
                  {
                     "name": "natalie-wake-up-call",
                     "rule": "00 9 * * 6-7",
                     "value": "false"
                  }
               ]
            },
            {
               "name": "at-home",
               "initialValue": false
            },
            {
               "name": "awake-at-home",
               "type": "andproperty",
               "initialValue": false,
               "sources": [
                  {
                     "name": "user:natalie",
                     "property": "at-home"
                  },
                  {
                     "name": "user:natalie",
                     "property": "in-bed",
                     "transform": "!$value"
                  }
               ]
            },
            {
               "name": "in-bed-at-home",
               "type": "andproperty",
               "initialValue": false,
               "sources": [
                  {
                     "name": "user:natalie",
                     "property": "at-home"
                  },
                  {
                     "name": "user:natalie",
                     "property": "in-bed"
                  }
               ]
            },
            {
               "name": "on-holiday",
               "initialValue": false
            }
         ]
      },
      {
         "name": "user:dylan",
         "displayName": "Dylan",
         "props": [
            {
               "name": "in-bed",
               "type": "scheduleproperty",
               "initialValue": false,
               "events": [
                  {
                     "name": "dylan-wake-up-call",
                     "rule": "15 7 * * 1-5",
                     "value": "false"
                  },
                  {
                     "name": "dylan-wake-up-call",
                     "rule": "00 10 * * 6-7",
                     "value": "false"
                  }
               ]
            },
            {
               "name": "at-home",
               "initialValue": false
            },
            {
               "name": "awake-at-home",
               "type": "andproperty",
               "initialValue": false,
               "sources": [
                  {
                     "name": "user:dylan",
                     "property": "at-home"
                  },
                  {
                     "name": "user:dylan",
                     "property": "in-bed",
                     "transform": "!$value"
                  }
               ]
            },
            {
               "name": "in-bed-at-home",
               "type": "andproperty",
               "initialValue": false,
               "sources": [
                  {
                     "name": "user:dylan",
                     "property": "at-home"
                  },
                  {
                     "name": "user:dylan",
                     "property": "in-bed"
                  }
               ]
            },
            {
               "name": "on-holiday",
               "initialValue": false
            }
         ]
      },
      {
         "name": "user:doggies",
         "displayName": "Emmie and Bruno",
         "props": [
            {
               "name": "at-home",
               "initialValue": false
            }
         ]
      },
      {
         "name": "usergroup:family",
         "displayName": "Collin Family",
         "users": [
           "user:richard",
           "user:natalie",
           "user:dylan"
         ],
         "props": [
            {
               "name": "awake-at-home",
               "type": "orproperty",
               "initialValue": false,
               "sources": [
                  {
                     "name": "user:richard",
                     "property": "awake-at-home"
                  },
                  {
                     "name": "user:natalie",
                     "property": "awake-at-home"
                  },
                  {
                     "name": "user:dylan",
                     "property": "awake-at-home"
                  }
               ]
            },
            {
               "name": "on-holiday",
               "initialValue": false,
               "type": "andproperty",
               "sources": [
                  {
                     "name": "user:richard",
                     "property": "on-holiday"
                  },
                  {
                     "name": "user:natalie",
                     "property": "on-holiday"
                  },
                  {
                     "name": "user:dylan",
                     "property": "on-holiday"
                  }
               ]
            },
            {
               "name": "at-home",
               "initialValue": false,
               "type": "orproperty",
               "sources": [
                  {
                     "name": "user:richard",
                     "property": "at-home"
                  },
                  {
                     "name": "user:natalie",
                     "property": "at-home"
                  },
                  {
                     "name": "user:dylan",
                     "property": "at-home"
                  }
               ]
            },
            {
               "name": "awake",
               "initialValue": true,
               "source": {
                  "name": "usergroup:family",
                  "property": "in-bed",
                  "transform": "!$value"
               }
            },
            {
               "name": "in-bed-at-home",
               "initialValue": false,
               "source": {
                  "name": "usergroup:family",
                  "property": "awake-at-home",
                  "transform": "!$value"
               }
            }
         ],
         "things": [
            {
               "name": "agent:family-holiday-agent",
               "agentProp": "on-holiday",
               "stateMap": {
                  "true": [
                     {
                        "name": "user:richard",
                        "property": "on-holiday",
                        "value": true
                     },
                     {
                        "name": "user:natalie",
                        "property": "on-holiday",
                        "value": true
                     },
                     {
                        "name": "user:dylan",
                        "property": "on-holiday",
                        "value": true
                     }
                  ]
               }
            }
         ]
      },
      {
         "name": "usergroup:admins",
         "displayName": "Administrators",
         "users": [
           "user:richard"
         ],
         "props": [
            {
               "name": "pushoverDestAddr",
               "initialValue": "gX5JLc28t775dYr1yjuo4p38t7hziV",
               "writable": false
            }
         ]
      },
      {
         "name": "usergroup:key-holders",
         "displayName": "Key Holders",
         "users": [
           "user:richard",
           "user:natalie"
         ],
         "props": [
            {
               "name": "pushoverDestAddr",
               "initialValue": "g7KTUJvsJbPUNH5SL8oEitXBBuL32j",
               "writable": false
            }
         ]
      }
   ],
   "services": [
      {
         "name": "scheduleservice",
         "latitude":  51.5,
         "longitude": -0.1,
         "forecastKey": "5d3be692ae5ea4f3b785973e1f9ea520"
      },
      {
         "name": "rampservice"
      }
   ],
   "things": [ 
      {
         "name": "thing:timed-environment",
         "displayName": "Timed Environment",
         "props": [
            {
               "name": "daylight",
               "initialValue": false,
               "writable": false,
               "type": "scheduleproperty",
               "events": [
                  {
                     "rule": "sunrise:1800",
                     "value": true
                  },
                  {
                     "rule": "sunset:-1800",
                     "value": false
                  }
               ]
            },
            {
               "name": "background-lights",
               "initialValue": false,
               "writable": false,
               "type": "scheduleproperty",
               "events": [
                  {
                     "rule": "sunset:900",
                     "value": true
                  },
                  {
                     "rule": "30 22 * * *",
                     "value": false
                  }
               ]
            },
            {
               "name": "low-light",
               "initialValue": false,
               "writable": false,
               "type": "scheduleproperty",
               "events": [
                  {
                     "rule": "sunset:-2700",
                     "value": true
                  },
                  {
                     "rule": "sunrise:3600",
                     "value": false
                  }
               ]
            },
            {
               "name": "bedtime",
               "initialValue": false,
               "writable": false,
               "type": "scheduleproperty",
               "events": [
                  {
                     "rule": "30 22 * * *",
                     "value": true
                  },
                  {
                     "rule": "15 23 * * *",
                     "value": false
                  }
               ]
            },
            {
               "name": "dylan-in-bed",
               "initialValue": false,
               "writable": false,
               "type": "scheduleproperty",
               "events": [
                  {
                     "rule": "00 21 * * 1-5",
                     "value": true
                  },
                  {
                     "rule": "30 22 * * 6-7",
                     "value": true
                  },
                  {
                     "rule": "30 7 * * 1-5",
                     "value": false
                  },
                  {
                     "rule": "30 9 * * 6-7",
                     "value": false
                  }
               ]
            }
         ]
      },
      {
         "name": "thing:environment",
         "displayName": "Environment",
         "props": [
            {
               "name": "daylight",
               "initialValue": false,
               "writable": false,
               "type": "topvalidproperty",
               "sources": [
                  {
                     "name": "thing:dumgoyne-environment",
                     "property": "daylight"
                  },
                  {
                     "name": "thing:timed-environment",
                     "property": "daylight"
                  }
               ]
            },
            {
               "name": "background-lights",
               "initialValue": false,
               "writable": false,
               "type": "topvalidproperty",
               "sources": [
                  {
                     "name": "thing:dumgoyne-environment",
                     "property": "background-lights"
                  },
                  {
                     "name": "thing:timed-environment",
                     "property": "background-lights"
                  }
               ]
            },
            {
               "name": "dark",
               "initialValue": false,
               "writable": false,
               "type": "invertproperty",
               "sources": [
                  {
                     "name": "thing:environment",
                     "property": "daylight"
                  }
               ]
            },
            {
               "name": "low-light",
               "initialValue": false,
               "writable": false,
               "type": "topvalidproperty",
               "sources": [
                  {
                     "name": "thing:dumgoyne-environment",
                     "property": "low-light"
                  },
                  {
                     "name": "thing:timed-environment",
                     "property": "low-light"
                  }
               ]
            },
            {
               "name": "bedtime",
               "initialValue": false,
               "writable": false,
               "type": "topvalidproperty",
               "sources": [
                  {
                     "name": "thing:timed-environment",
                     "property": "bedtime"
                  }
               ]
            }
         ]
      }
   ]
}
