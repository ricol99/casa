{
   "name": "casa:env",
   "displayName": "Dumgoyne Environment Casa",
   "gang": "casa-collin-v2",
   "parentCasa": {
      "name": "casa:internet",
      "address": {
         "hostname": "199.245.56.152",
         "port": 443
      }
   },
   "listeningPort": 8097,
   "props": [],
   "services": [
      {
         "name": "homekitservice",
         "displayName": "Homekit Service",
         "pincode": "111-11-111",
         "username": "CC:22:3D:E4:CF:ED",
         "manufacturer": "Casa Collin Ltd",
         "model": "V0.1",
         "serialNumber": "1234567890"
      },
      {
         "name": "sonosservice",
         "displayName": "Sonos Discovery Service"
      },
      {
         "name": "webservice",
         "displayName": "Web Server Service",
         "port": 80,
         "mediaPath": "/web/media",
         "secure": false,
         "serverKey": "",
         "serverCert": "",
         "caCert": ""
      },
      {
         "name": "lightwaverfservice",
         "displayName": "LightwaveRF Link Service",
         "linkAddress": "192.168.1.236"
      }
   ],
   "things": [
      {
         "name": "hklightsensoraccessory:hk-ambient-light-sensor",
         "displayName": "Ambient Light Level",
         "pincode": "111-11-111",
         "username": "CC:22:3D:E3:CE:3D",
         "manufacturer": "Casa Home Automation Ltd",
         "model": "V0.1",
         "serialNumber": "1234567890",
         "props": [
            {
               "name": "light-level",
               "initialValue": 0,
               "writable": false,
               "source": {
                  "name": "thing:dumgoyne-sensors",
                  "property": "light-sensor",
                  "transform": "$value*$value"
               }
            }
         ]
      },
      {
         "name": "thing:dumgoyne-sensors",
         "displayName": "Environment Sensors in Dumgoyne",
         "props": [
            {
               "name": "light-sensor",
               "type": "i2cproperty",
               "initialValue": 0,
               "writable": false,
               "address1": 104,
               "address2": 105,
               "channel": 1,
               "interval": 5,
               "maxChange": 5,
               "maxIgnore": 18,
               "inputMin": 3.291,
               "inputMax": 0,
               "outputMin": 1,
               "outputMax": 100,
               "outputResolution": 99,
               "floorOutput": true
            }
         ]
      },
      {
         "name": "thing:dumgoyne-environment",
         "displayName": "Environment Based on Sensors in Dumgoyne",
         "props": [
            {
               "name": "daylight-threshold",
               "type": "thresholdproperty",
               "initialValue": false,
               "writable": false,
               "threshold" : 47,
               "buffer": 7,
               "transform": "$value>=47",
               "source": {
                  "name": "thing:dumgoyne-sensors",
                  "property": "light-sensor"
               }
            },
            {
               "name": "daylight-possible",
               "initialValue": false,
               "writable": false,
               "type": "scheduleproperty",
               "events": [
                  {
                     "rule": "sunrise:-600",
                     "propertyValue": true
                  },
                  {
                     "rule": "sunset:+600",
                     "propertyValue": false
                  }
               ]
            },
            {
               "name": "daylight",
               "initialValue": false,
               "writable": false,
               "type": "andproperty",
               "sources": [
                  {
                     "name": "thing:dumgoyne-environment",
                     "property": "daylight-threshold"
                  },
                  {
                     "name": "thing:dumgoyne-environment",
                     "property": "daylight-possible"
                  }
               ]
            },
            {
               "name": "low-light-threshold",
               "initialValue": false,
               "writable": false,
               "type": "thresholdproperty",
               "threshold" : 63,
               "buffer": 7,
               "transform": "$value<=63",
               "source": {
                  "name": "thing:dumgoyne-sensors",
                  "property": "light-sensor"
               }
            },
            {
               "name": "low-light",
               "initialValue": false,
               "writable": false,
               "type": "andproperty",
               "sources": [
                  {
                     "name": "thing:dumgoyne-environment",
                     "property": "low-light-threshold"
                  },
                  {
                     "name": "alarmtexecom:dumgoyne",
                     "property": "part-armed",
                     "transform": "!$value"
                  }
               ]
            },
            {
               "name": "background-lights",
               "initialValue": false,
               "writable": true,
               "type": "scheduleproperty",
               "source": {
                  "name": "thing:dumgoyne-environment",
                  "property": "daylight",
                  "transform": "!$value"
               },
               "events": [
                  {
                     "rule": "30 22 * * *",
                     "propertyValue": false
                  }
               ]
            },
            {
               "name": "richard-at-home",
               "initialValue": false,
               "writable": false,
               "type": "devicepresentproperty",
               "host": "192.168.1.128",
               "interval": 60,
               "sourceSteps": [
                  {
                     "type": "latchstep",
                     "minOutputTime": 600
                  }
               ]
            }
         ]
      },
      {
         "name": "thing:dumgoyne-broadband",
         "displayName": "Dumgoyne Internet Connection",
         "things": [
            {
               "name": "broadbandspeedtester:dumgoyne",
               "maxTime": 5000,
               "schedule": "0 2 * * *"
            }
         ]
      },
      {
         "name": "room:kitchen",
         "displayName": "Kitchen Room",
         "props": [
            {
               "name": "movement-pir",
               "initialValue": false,
               "writable": false,
               "type": "gpioproperty",
               "gpioPin": 17,
               "triggerLow": true,
               "local": true
            },
            {
               "name": "movement-in-low-light",
               "initialValue": false,
               "writable": false,
               "type": "andproperty",
               "sources": [
                  {
                     "name": "thing:environment",
                     "property": "low-light"
                  },
                  {
                     "name": "room:kitchen",
                     "property": "movement-pir"
                  }
               ],
               "sourceSteps": [
                  {
                     "type": "latchstep",
                     "minOutputTime": 600
                  }
               ]
            }
         ],
         "things": [
            {
               "name": "hklightaccessory:kitchen-lights",
               "displayName": "Kitchen Lights",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:33",
               "manufacturer": "Lightwave RF Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "brightnessSupported": true,
               "props": [
                  {
                     "name": "brightness",
                     "initialValue": 0,
                     "writable": false,
                     "type": "orproperty",
                     "prioritiseSources": true,
                     "sources": [
                        {
                           "name": "room:kitchen",
                           "property": "movement-in-low-light",
                           "outputValues": {
                              "true": 60,
                              "false": 0
                           }
                        },
                        {
                           "name": "thing:environment",
                           "property": "background-lights",
                           "outputValues": {
                              "true": 25,
                              "false": 0
                           }
                        }
                     ]
                  },
                  {
                     "name": "power",
                     "initialValue": false,
                     "writable": false,
                     "source": {  
                        "name": "room:kitchen",
                        "property": "brightness",
                        "transform": "$value>0"
                     } 
                  }
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:kitchen-ceiling-lights",
                     "displayName": "Kitchen Ceiling Lights",
                     "roomID": 2,
                     "deviceID": 1,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  },
                  {
                     "name": "lightwaverfaccessory:kitchen-island-lights",
                     "displayName": "Kitchen Island Lights",
                     "roomID": 2,
                     "deviceID": 2,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  },
                  {
                     "name": "lightwaverfaccessory:kitchen-cupboards-lights",
                     "displayName": "Kitchen Cupboard Lights",
                     "roomID": 6,
                     "moods": [
                        {
                           "name": "low",
                           "id": 1,
                           "low": 1,
                           "high": 33
                        },
                        {
                           "name": "medium",
                           "id": 2,
                           "low": 34,
                           "high": 76
                        },
                        {
                           "name": "full",
                           "id": 3,
                           "low": 77,
                           "high": 100
                        }
                     ],
                     "props": [
                     ]
                  }
               ]
            }
         ]
      },
      {
         "name": "room:lounge",
         "displayName": "Lounge Room",
         "props": [
            {
               "name": "movement-pir",
               "initialValue": false,
               "writable": false,
               "type": "gpioproperty",
               "gpioPin": 27,
               "triggerLow": true,
               "local": true
            },
            {
               "name": "movement-in-low-light",
               "initialValue": false,
               "writable": false,
               "type": "andproperty",
               "sources": [
                  {
                     "name": "thing:environment",
                     "property": "low-light"
                  },
                  {
                     "name": "room:lounge",
                     "property": "movement-pir"
                  }
               ],
               "sourceSteps": [
                  {
                     "type": "latchstep",
                     "minOutputTime": 600
                  }
               ]
            }
         ],
         "things": [
            {
               "name": "hklightaccessory:lounge-lights",
               "displayName": "Lounge Lights",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:31",
               "manufacturer": "Lounge Light Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "brightnessSupported": true,
               "props": [
                  {
                     "name": "brightness",
                     "initialValue": 0,
                     "writable": false,
                     "type": "orproperty",
                     "prioritiseSources": true,
                     "sources": [
                        {
                           "name": "room:lounge",
                           "property": "movement-in-low-light",
                           "outputValues": {
                              "true": 60,
                              "false": 0
                           }
                        },
                        {
                           "name": "thing:environment",
                           "property": "background-lights",
                           "outputValues": {
                              "true": 25,
                              "false": 0
                           }
                        }
                     ]
                  },
                  {
                     "name": "power",
                     "initialValue": false,
                     "writable": false,
                     "source": {
                        "name": "room:lounge",
                        "property": "brightness",
                        "transform": "$value>0"
                     }
                  }
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:wall-lights",
                     "displayName": "Lounge Wall Lights",
                     "roomID": 1,
                     "deviceID": 1,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  },
                  {
                     "name": "lightwaverfaccessory:table-lamps",
                     "displayName": "Lounge Table Lamps",
                     "roomID": 1,
                     "deviceID": 2,
                     "brightnessThreshold": 30,
                     "props": [
                     ]
                  }
               ]
            },
            {
               "name": "hkspeakeraccessory:lounge-speakers",
               "displayName": "Lounge Speakers",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:3F",
               "manufacturer": "Lounge Speaker Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "volumeSupported": true,
               "props": [
               ],
               "things": [
                  {
                     "name": "sonosplayer:living-room",
                     "displayName": "Sonos Player for Living Room",
                     "zone": "Living Room"
                  }
               ]
            }
         ]
      },
      {
         "name": "room:outside",
         "displayName": "Outside",
         "props": [
            {
               "name": "movement-1-pir",
               "initialValue": false,
               "writable": false,
               "type": "gpioproperty",
               "gpioPin": 25,
               "triggerLow": true,
               "local": true
            },
            {
               "name": "movement-in-the-dark",
               "initialValue": false,
               "writable": false,
               "type": "andproperty",
               "sources": [
                  {
                     "name": "thing:environment",
                     "property": "dark"
                  },
                  {
                     "name": "room:outside",
                     "property": "movement-1-pir"
                  }
               ],
               "sourceSteps": [
                  {
                     "type": "latchstep",
                     "minOutputTime": 60
                  }
               ]
            },
            {
               "name": "brightness",
               "initialValue": 0,
               "writable": false,
               "source": {
                  "name": "room:outside",
                  "property": "movement-in-the-dark",
                  "outputValues": {
                     "true": 100,
                     "false": 0
                  }
               }
            },
            {
               "name": "power",
               "initialValue": false,
               "writable": false,
               "source": {
                  "name": "room:outside",
                  "property": "brightness",
                  "transform": "$value>0"
               }
            }
         ],
         "things": [
            {
               "name": "hklightaccessory:back-door-outside-light",
               "displayName": "Back Door Outside Light",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:37",
               "manufacturer": "LightwaveRF Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "props": [
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:back-door-outside-light",
                     "displayName": "Back Door Outside Light",
                     "roomID": 3,
                     "deviceID": 1,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  }
               ]
            },
            {
               "name": "hklightaccessory:rear-garden-outside-lights",
               "displayName": "Rear Garden Outside Lights",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:38",
               "manufacturer": "LightwaveRF Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "props": [
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:bifold-outside-light",
                     "displayName": "Bifold Outside Light",
                     "roomID": 3,
                     "deviceID": 2,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  },
                  {
                     "name": "lightwaverfaccessory:lounge-outside-light",
                     "displayName": "Lounge Outside Light",
                     "roomID": 3,
                     "deviceID": 3,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  }
               ]
            }
         ]
      },
      {
         "name": "room:hall-landing-snug",
         "displayName": "Hall, Landing and Snug Rooms",
         "props": [
         ],
         "things": [
            {
               "name": "hklightaccessory:hall-table-lamp",
               "displayName": "Hall Table Lamp",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:39",
               "manufacturer": "LightwaveRF Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "props": [
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:hall-table-lamp",
                     "displayName": "Hall Table Lamp",
                     "roomID": 4,
                     "deviceID": 1,
                     "props": [
                     ]
                  }
               ]
            },
            {
               "name": "hklightaccessory:loo-main-light",
               "displayName": "Loo Light",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:3A",
               "manufacturer": "LightwaveRF Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "brightnessSupported": true,
               "props": [
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:loo-main-light",
                     "displayName": "Loo Lights",
                     "roomID": 4,
                     "deviceID": 2,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  }
               ]
            },
            {
               "name": "hklightaccessory:snug-main-light",
               "displayName": "Snug Light",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:3B",
               "manufacturer": "LightwaveRF Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "brightnessSupported": true,
               "props": [
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:snug-main-light",
                     "displayName": "Snug Lights",
                     "roomID": 4,
                     "deviceID": 3,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  }
               ]
            }
         ]
      },
      {
         "name": "room:utility-room",
         "displayName": "Utility Room",
         "props": [
         ],
         "things": [
            {
               "name": "hklightaccessory:utility-lights",
               "displayName": "Utility Lights",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:3C",
               "manufacturer": "LightwaveRF Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "brightnessSupported": true,
               "props": [
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:utility-main-light",
                     "displayName": "Utility Light",
                     "roomID": 2,
                     "deviceID": 3,
                     "brightnessSupported": true,
                     "props": [
                     ]
                  }
               ]
            }
         ]
      },
      {
         "name": "room:dylan-bedroom",
         "displayName": "Dylan's Bedroom",
         "props": [
         ],
         "things": [
            {
               "name": "hkspeakeraccessory:dylan-bedroom-speakers",
               "displayName": "Dylan's Bedroom Speakers",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:3E",
               "manufacturer": "Lounge Speaker Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "volumeSupported": true,
               "props": [
               ],
               "things": [
                  {
                     "name": "sonosplayer:dylan-bedroom",
                     "displayName": "Sonos Player for Dylan's Bedroom",
                     "zone": "Dylan's Room",
                     "props": [
                        {
                           "name": "playing",
                           "type": "edgeproperty",
                           "writable": true,
                           "leadingEdgeOutput": false,
                           "source": {
                              "name": "alarmtexecom:dumgoyne",
                              "property": "part-armed"
                           }
                        }
                     ]
                  }
               ]
            }
         ]
      },
      {
         "name": "room:master-bedroom",
         "displayName": "Master Bedroom",
         "props": [
         ],
         "things": [
            {
               "name": "hklightaccessory:master-bedroom-lights",
               "displayName": "Bedroom Lights",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:36",
               "manufacturer": "LightwaveRF Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "props": [
                  {
                     "name": "power",
                     "initialValue": false,
                     "source": {
                        "name": "thing:environment",
                        "property": "bedtime"
                     }
                  }
               ],
               "things": [
                  {
                     "name": "lightwaverfaccessory:natalie-table-lamp",
                     "displayName": "Natalie Table Lamp",
                     "roomID": 1,
                     "deviceID": 3,
                     "props": [
                     ]
                  }
               ]
            }
         ]
      },
      {
         "name": "alarm:dumgoyne",
         "displayName": "House Alarm",
         "props": [
            {
               "name": "tamper-alarm",
               "initialValue": false,
               "writable": false,
               "type": "gpioproperty",
               "gpioPin": 8,
               "triggerLow": true
            },
            {
               "name": "fire-alarm",
               "initialValue": false,
               "writable": false,
               "type": "gpioproperty",
               "gpioPin": 18,
               "triggerLow": true
            },
            {
               "name": "zone-alarm",
               "initialValue": false,
               "writable": false,
               "type": "gpioproperty",
               "gpioPin": 24,
               "triggerLow": true
            }
         ]
      },
      {
         "name": "alarmtexecom:dumgoyne",
         "displayName": "Dumgoyne Alarm",
         "pollingInterval": 2,
         "maxPollMisses": 1,
         "serverPort": 8200,
         "secureConfig": true,
         "props": [
            {
               "name": "part-armed",
               "initialValue": false,
               "writable": false,
               "type": "gpioproperty",
               "gpioPin": 23,
               "triggerLow": true
            },
            {
               "name": "fully-armed",
               "initialValue": false,
               "writable": false,
               "type": "gpioproperty",
               "gpioPin": 22,
               "triggerLow": true
            }
         ],
         "things": [
            {
               "name": "hksecuritysystem:dumgoyne",
               "displayName": "Dumgoyne Security System",
               "pincode": "111-11-111",
               "username": "CC:22:3D:E3:CE:40",
               "manufacturer": "Casa Home Automation Ltd",
               "model": "V0.1",
               "serialNumber": "1234567890",
               "props": [
               ]
            }
         ]
      }
   ]
}
