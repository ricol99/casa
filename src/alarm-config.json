{
   "name": "casa:alarm",
   "displayName": "Casa Collin Texecom Alarm",
   "gang": "casa-collin",
   "parentCasa": {
      "name": "casa:internet",
      "address": {
         "hostname": "casa-dev.elasticbeanstalk.com",
         "port": 80
      }
   },
   "listeningPort": 8081,
   "users": [],
   "props": [],
   "things": [
      {
         "name": "lightwaverflink:home",
         "displayName": "LightwaveRF Wifi Link",
         "props": [
            {
               "name": "ipAddress",
               "initialValue": "192.168.1.236",
               "writable": false
            }
         ]
      },
      {
         "name": "alarm:home",
         "displayName": "House Alarm",
         "props": [
            {
               "name": "ipAddress",
               "initialValue": "192.168.1.90",
               "writable": false
            },
            {
               "name": "tamper-alarm",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "gpiopropertybinder:alarm-tamper",
                  "gpioPin": 4,
                  "triggerLow": true
               }
            },
            {
               "name": "kitchen-pir",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "gpiopropertybinder:kitchen-pir",
                  "gpioPin": 17,
                  "triggerLow": true
               }
            },
            {
               "name": "fire-alarm",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "gpiopropertybinder:fire-alarm",
                  "gpioPin": 18,
                  "triggerLow": true
               }
            },
            {
               "name": "fully-armed",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "gpiopropertybinder:fully-armed",
                  "gpioPin": 22,
                  "triggerLow": true
               }
            },
            {
               "name": "part-armed",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "gpiopropertybinder:part-armed",
                  "gpioPin": 23,
                  "triggerLow": true
               }
            },
            {
               "name": "alarm-triggered",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "gpiopropertybinder:alarm-triggered",
                  "gpioPin": 24,
                  "triggerLow": true
               }
            },
            {
               "name": "confirmed-alarm",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "gpiopropertybinder:confirmed-alarm",
                  "gpioPin": 25,
                  "triggerLow": true
               }
            },
            {
               "name": "lounge-pir",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "gpiopropertybinder:lounge-pir",
                  "gpioPin": 27,
                  "triggerLow": true
               }
            }
         ]
      },
      {
         "name": "room:lounge",
         "displayName": "Lounge Room",
         "props": [
            {
               "name": "movement",
               "initialValue": false,
               "writable": false,
               "binder" : {
                  "name": "latchingpropertybinder:lounge-movement",
                  "target": "alarm:home",
                  "targetProperty": "lounge-pir",
                  "triggerCondition": "==",
                  "triggerValue": true,
                  "minOutputTime": 180
               }
            },
            {
               "name": "room-light-level",
               "initialValue": "low",
               "writable": true
            },
            {
               "name": "lounge-fire-light-level",
               "initialValue": 0,
               "writable": true,
               "binder": {
                  "name": "lightwaverfpropertybinder:lounge-fire-light",
                  "target": "lightwaverflink:home",
                  "roomID": 1,
                  "deviceID": 3
               }
            },
            {
               "name": "lounge-alcoves-light-level",
               "initialValue": 0,
               "writable": 0,
               "binder": {
                  "name": "lightwaverfpropertybinder:lounge-alcoves-light",
                  "target": "lightwaverflink:home",
                  "roomID": 1,
                  "deviceID": 2
               }
            },
            {
               "name": "lounge-table-light",
               "initialValue": false,
               "writable": true,
               "binder": {
                  "name": "lightwaverfpropertybinder:lounge-table-light",
                  "target": "lightwaverflink:home",
                  "roomID": 1,
                  "deviceID": 1
               }
            },
            {
               "name": "lounge-centre-light",
               "initialValue": false,
               "writable": true,
               "binder": {
                  "name": "lightwaverfpropertybinder:lounge-centre-light",
                  "target": "lightwaverflink:home",
                  "roomID": 1,
                  "deviceID": 4
               }
            },
            {
               "name": "lounge-tree-light",
               "initialValue": false,
               "writable": true,
               "binder": {
                  "name": "lightwaverfpropertybinder:lounge-tree-light",
                  "target": "lightwaverflink:home",
                  "roomID": 1,
                  "deviceID": 5
               }
            }
         ]
      },
      {
         "name": "room:master-bedroom",
         "displayName": "Master Bedroom",
         "props": [
            {
               "name": "lights",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "schedulepropertybinder:master-bedroom-lights",
                  "events": [
                     {
                        "rule": "20 22 * * *",
                        "propertyValue": true
                     },
                     {
                        "rule": "15 23 * * *",
                        "propertyValue": false
                     }
                  ]
               }
            }
         ]
      },
      {
         "name": "thing:environment",
         "displayName": "Environment",
         "props": [
            {
               "name": "sunset-for-four-hours",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "schedulepropertybinder:env-sunset-for-four-hours",
                  "events": [
                     {
                        "rule": "sunset",
                        "propertyValue": true
                     },
                     {
                        "rule": "sunset:14400",
                        "propertyValue": false
                     }
                  ]
               }
            },
            {
               "name": "lengthened-daylight",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "schedulepropertybinder:env-lengthened-daylight",
                  "events": [
                     {
                        "rule": "sunrise:-900",
                        "propertyValue": true
                     },
                     {
                        "rule": "sunset:900",
                        "propertyValue": false
                     }
                  ]
               }
            },
            {
               "name": "daylight",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "schedulepropertybinder:env-daylight",
                  "events": [
                     {
                        "rule": "sunrise",
                        "propertyValue": true
                     },
                     {
                        "rule": "sunset",
                        "propertyValue": false
                     }
                  ]
               }
            },
            {
               "name": "living-area-lights-with-movement-times",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "schedulepropertybinder:env-living-area-lights-early",
                  "events": [
                     {
                        "rule": "30 2 * * *",
                        "propertyValue": false 
                     },
                     {
                        "rule": "sunset:-4500",
                        "propertyValue": true
                     }
                  ]
               }
            },
            {
               "name": "living-area-lights-normal-times",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "schedulepropertybinder:env-living-area-lights-late",
                  "events": [
                     {
                        "rule": "sunset:-2600",
                        "propertyValue": true
                     },
                     {
                        "rule": "30 22 * * *",
                        "propertyValue": false 
                     }
                  ]
               }
            }
         ]
      }
   ],
   "transforms" : [],
   "activators": [
      {
         "name": "latchingactivator:lounge-movement",
         "source": "alarm:home",
         "sourceProperty": "lounge-pir",
         "minOutputTime": 10,
         "applyProps": {
            "active" : {
               "movement": true,
               "lounge-centre-light": true 
            },
            "inactive" : {
               "movement": false,
               "lounge-centre-light": false 
            }
         }
      },
      {
         "name": "propertyactivator:holiday-background-lights",
         "source": "thing:environment",
         "sourceProperty": "living-area-lights-normal-times",
         "applyProps": {
            "active" : {
               "room-light-level": 40 
            },
            "inactive" : {
               "room-light-level": 0
            }
         }
      },
      {
         "name": "oractivator:lounge-lights-with-movement",
         "sources": [
            {
               "source": "room:lounge",
               "sourceProperty": "movement"
            },
            {
               "source": "thing:environment",
               "sourceProperty": "living-area-lights-with-movement-times"
            }
         ],
         "applyProps": {
            "active" : {
               "room-light-level": 60 
            },
            "inactive" : {
               "room-light-level": 0 
            }
         }
      },
      {
         "name": "oractivator:lounge-lights-evening",
         "sources": [
            "oractivator:lounge-lights-with-movement",
            "propertyactivator:holiday-background-lights"
         ]
      }
   ],
   "actions": [
      {
         "name": "setpropertyaction:update-lounge-centre-light",
         "source": "latchingactivator:lounge-movement",
         "target": "room:lounge",
         "targetProperty": "lounge-centre-light"
      },
      {
         "name": "setpropertyaction:update-lounge-movement",
         "source": "latchingactivator:lounge-movement",
         "target": "room:lounge",
         "targetProperty": "movement"
      },
      {
         "name": "setpropertyaction:update-lounge-light-level",
         "source": "oractivator:lounge-lights-evening",
         "target": "room:lounge",
         "targetProperty": "room-light-level"
      },
      {
         "name": "spycameraaction:lounge",
         "cctvHostname": "192.168.1.245",
         "cctvPort": 8000,
         "userId": "ricol99",
         "password": "carrot99",
         "cameraId": 1,
         "source": "andactivator:lounge-activity"
      },
      {
         "name": "lightwaverfaction:natalie-bedroom-table-lamp",
         "roomId": 3,
         "deviceId": 1,
         "source": "room:master-bedroom",
         "sourceProperty": "lights",
         "target": "lightwaverflink:home"
      }
   ]
}
