{
   "name": "casa:internet",
   "displayName": "Casa Collin Internet Casa",
   "gang": "casa-collin",
   "area": {
      "name": "casaarea:internet",
      "displayName": "Casa Collin Internet"
   },
   "listeningPort": 8096,
   "props": [],
   "users": [ 
      {
         "name": "user:richard",
         "displayName": "Richard",
         "props": []
      },
      {
         "name": "user:natalie",
         "displayName": "Natalie",
         "props": []
      },
      {
         "name": "usergroup:admins",
         "displayName": "Administrators",
         "users": [
           "user:richard"
         ],
         "props": [
            {
               "name": "pushoverDestAddr",
               "initialValue": "gX5JLc28t775dYr1yjuo4p38t7hziV",
               "writable": false,
               "binder": {
                  "name": "i2cpropertybinder:pushoverDestAddr",
                  "address": 24
               }
            }
         ]
      },
      {
         "name": "usergroup:key-holders",
         "displayName": "Key Holders",
         "users": [
           "user:richard",
           "user:natalie"
         ],
         "props": [
            {
               "name": "pushoverDestAddr",
               "initialValue": "g7KTUJvsJbPUNH5SL8oEitXBBuL32j",
               "writable": false
            }
         ]
      }
   ],
   "things": [
      {
         "name": "thing:home-internet-connection",
         "displayName": "Home Internet Connection",
         "props": [
            {
               "name": "ACTIVE",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "orpropertybinder:home-casas",
                  "sources": [
                     {
                        "source": "thing:home-internet-connection",
                        "sourceProperty": "casa-alarm"
                     },
                     {
                        "source": "thing:home-internet-connection",
                        "sourceProperty": "casa-cctv"
                     }
                  ]
               }
            },
            {
               "name": "casa-alarm",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "debouncingpropertybinder:casa-alarm",
                  "source": "casa:alarm",
                  "sourceProperty": "ACTIVE",
                  "threshold": 120
               }
            },
            {
               "name": "casa-cctv",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "debouncingpropertybinder:casa-cctv",
                  "source": "casa:cctv",
                  "sourceProperty": "ACTIVE",
                  "threshold": 120
               }
            },
            {
               "name": "alarm-armed",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "orpropertybinder:alarm-armed",
                  "sources": [
                     {
                        "source": "alarm:home",
                        "sourceProperty": "fully-armed"
                     },
                     {
                        "source": "alarm:home",
                        "sourceProperty": "part-armed"
                     }
                  ]
               }
            },
            {
               "name": "debounced-alarm-armed",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "debouncingpropertybinder:alarm-armed",
                  "source": "thing:home-internet-connection",
                  "sourceProperty": "alarm-armed",
                  "threshold": 30
               }
            },
            {
               "name": "lost-while-armed",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "andpropertybinder:home-internet-lost-while-armed",
                  "sources": [
                     {
                        "source": "casa-alarm",
                        "sourceProperty": "ACTIVE",
                        "triggerCondition": "==",
                        "triggerValue": false
                     },
                     {
                        "source": "thing:home-internet-connection",
                        "sourceProperty": "debounced-alarm-armed"
                     }
                  ]
               }
            }
         ]
      },
      {
         "name": "thing:pushover-messenger",
         "displayName": "Pushover Messenger",
         "props": [
            {
               "name": "priority-message",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "pushoverbinder:priority-message",
                  "priority": 2,
                  "target": "usergroup:key-holders",
                  "sources": [
                     {
                        "source": "alarm:home",
                        "sourceProperty": "tamper-alarm",
                        "outputValues": {
                           "true": "D-Alarm being tampered with!",
                           "false": "D-Alarm no longer in tamper mode"
                        }
                     },
                     {
                        "source": "alarm:home",
                        "sourceProperty": "mains-failure",
                        "outputValues": {
                           "true": "D-Alarm has lost mains power!",
                           "false": "D-Alarm mains power restored"
                        }
                     },
                     {
                        "source": "alarm:home",
                        "sourceProperty": "fire-alarm",
                        "outputValues": {
                           "true": "D-Fire Alarm!",
                           "false": "D-Fire alarm reset"
                        }
                     },
                     {
                        "source": "alarm:home",
                        "sourceProperty": "alarm-triggered",
                        "outputValues": {
                           "true": "D-Alarm triggered",
                           "false": "D-Alarm trigger reset"
                        }
                     },
                     {
                        "source": "alarm:home",
                        "sourceProperty": "confirmed-alarm",
                        "outputValues": {
                           "true": "D-Alarm confirmed - call police!",
                           "false": "D-Confirmed alarm reset"
                        }
                     },
                     {
                        "source": "thing:home-internet-connection",
                        "sourceProperty": "casa-alarm",
                        "outputValues": {
                           "true": "D-Internet connection to home has been lost while alarm is fully armed!",
                           "false": "D-Internet connection to home restored"
                        }
                     }
                  ]
               }
            },
            {
               "name": "urgent-message",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "pushoverbinder:urgent-message",
                  "priority": 1,
                  "target": "usergroup:admins",
                  "sources": [
                     {
                        "source": "thing:home-internet-connection",
                        "sourceProperty": "ACTIVE",
                        "outputValues": {
                           "true": "D-Internet connection to home restored",
                           "false": "D-Internet connection to home has been lost!"
                        }
                     },
                     {
                        "source": "thing:home-internet-connection",
                        "sourceProperty": "casa-alarm",
                        "outputValues": {
                           "true": "D-Casa 'alarm' is active",
                           "false": "D-Casa 'alarm' has gone down!"
                        }
                     },
                     {
                        "source": "thing:home-internet-connection",
                        "sourceProperty": "casa-cctv",
                        "outputValues": {
                           "true": "D-Casa 'cctv' is active",
                           "false": "D-Casa 'cctv' has gone down!"
                        }
                     }
                  ]
               }
            },
            {
               "name": "normal-message",
               "initialValue": false,
               "writable": false,
               "binder": {
                  "name": "pushoverbinder:normal-message",
                  "priority": 0,
                  "target": "usergroup:admins",
                  "sources": [
                     {
                        "source": "alarm:home",
                        "sourceProperty": "fully-armed",
                        "outputValues": {
                           "true": "D-Alarm armed",
                           "false": "D-Alarm disarmed"
                        }
                     },
                     {
                        "source": "alarm:home",
                        "sourceProperty": "part-armed",
                        "outputValues": {
                           "true": "D-Alarm part armed",
                           "false": "D-Alarm disarmed"
                        }
                     },
                     {
                        "source": "thing:environment",
                        "sourceProperty": "daylight",
                        "outputValues": {
                           "true": "D-Good morning!",
                           "false": "D-Good evening!"
                        }
                     },
                     {
                        "source": "thing:test-cctv",
                        "sourceProperty": "test-prop-2",
                        "outputValues": {
                           "true": "D-Test CCTV ACTIVE!",
                           "false": "D-Test CCTV INACTIVE!"
                        }
                     }
                  ]
               }
            }
         ]
      }
   ]
}
